var notError=function(e){"use strict";function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,u,"next",e)}function u(e){r(a,o,i,s,u,"throw",e)}s(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t,r){return(f=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&l(o,r.prototype),o}).apply(null,arguments)}function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return f(e,arguments,c(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?v(e):t}function g(e){var t=p();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d(this,r)}}function y(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w=function(e){u(r,e);var t=g(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o(this,r),(n=t.call(this,e)).options=i,n.adopt(a),n.fill(),n.getTime(),d(n,v(n))}return a(r,[{key:"adopt",value:function(e){return e instanceof Error&&(this.parent=e),this}},{key:"getStack",value:function(){return this.parent?this.parent.stack:this.stack}},{key:"getDetails",value:function(){var e=this;return this.parent&&(e=this.parent),{columnNumber:e.columnNumber,fileName:e.fileName,lineNumber:e.lineNumber,name:e.name,message:e.message,stack:e.stack}}},{key:"getTime",value:function(){var e=new Date;return this.env.date={timestamp:e.getTime(),offset:e.getTimezoneOffset()},this.env.date}},{key:"fill",value:function(){return this.env={browser:!0,node:!1,document:{title:document.title},location:{hash:window.location.hash,port:window.location.port,protocol:window.location.protocol,search:window.location.search,host:window.location.host,url:window.location.url,href:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname},navigator:{appName:navigator.appName,appCodeName:navigator.appCodeName,appVersion:navigator.appVersion,userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,product:navigator.product,onLine:navigator.onLine,cookieEnabled:navigator.cookieEnabled},window:{height:window.innerHeight,width:window.innerWidth}},this}}]),r}(h(Error)),k=function(e){u(r,e);var t=g(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(this,r),d(n=t.call(this,e,{fields:i,params:s},a),v(n))}return a(r,[{key:"setFieldsErrors",value:function(e){this.options.fields=e}},{key:"getFieldsErrors",value:function(){return this.options.fields}}]),r}(w),R=function(e){u(r,e);var t=g(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{code:500,errors:{},redirect:!1,params:{}},a=i.code,s=i.errors,u=i.redirect,c=i.params,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o(this,r),d(n=t.call(this,e,{code:a,errors:s,redirect:u,params:c},l),v(n))}return a(r,[{key:"setRedirect",value:function(e){this.options.redirect=e}},{key:"getRedirect",value:function(){return this.options.redirect}},{key:"setCode",value:function(e){this.options.code=e}},{key:"getCode",value:function(){return this.options.code}},{key:"setErrors",value:function(e){this.options.errors=e}},{key:"getErrors",value:function(){return this.options.errors}},{key:"getResult",value:function(){return{message:this.message,code:this.getCode(),errors:this.getErrors(),redirect:this.getRedirect()}}}]),r}(w),b=["report@","notError@"],O=["file","path","type","line","column","function"],E=[{test:function(e){var t=y(e.matchAll(/(.*)@(.+):(\d+):(\d+)/gi));if(t.length){var r=t[0];if(r&&r.length>2)return r}return!1},parse:function(e){if(e){var t=e[1].split("."),r=e[2].split("/"),n=r[r.length-1];r.pop();var o,i=r.join("/"),a=parseInt(e[3]),s=parseInt(e[4]),u=t[t.length-1];return u.replaceAll&&(u=u.replaceAll("/","").replaceAll("\\","").replaceAll(">","").replaceAll("<","")),r&&r.length&&(o=r.pop()),{file:n,path:i,line:a,column:s,function:u,type:o}}return!1}},{test:function(e){var t=y(e.matchAll(/\sat\s(.+)\s\((.+)\)/gi));if(t.length){var r=t[0];if(r&&r.length>2)return r}return!1},parse:function(e){if(e){var t=e[1].split("."),r=e[2].split(":"),n=r[0].split("/"),o=n[n.length-1];n.pop();var i,a=n.join("/"),s=parseInt(r[1]),u=parseInt(r[2]),c=t[t.length-1];return c.replaceAll&&(c=c.replaceAll("/","").replaceAll("\\","").replaceAll(">","").replaceAll("<","")),n&&n.length&&(i=n.pop()),{file:o,path:a,line:s,column:u,function:c,type:i}}return!1}}],_=window.console,N="/browser/api",S="test.key",T={envFirst:!1,origin:{},url:void 0,key:void 0,registerAll:!0},j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T;o(this,e);var r=t.envFirst,n=t.origin,i=t.url,a=t.key,s=t.registerAll;return this.envFirst=r,this.processWatching=!1,this.setOrigin(n),this.setKey(a),this.setURL(i),this.setRegisterAll(s),window.addEventListener("error",this.registerError.bind(this)),this}var r,i,u,c;return a(e,[{key:"setOrigin",value:function(e){return this.origin=e,this}},{key:"setKey",value:function(e){return this.key=e,this}},{key:"setURL",value:function(e){return this.url=e,this}},{key:"setRegisterAll",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.registerAll=e,this}},{key:"errorIsReportable",value:function(e){return e instanceof w}},{key:"report",value:(c=n(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,this.errorIsReportable(t)||(t=new w(t.message,{},t),n=!0),e.next=4,this.packError(t,n);case 4:return o=e.sent,e.next=7,this._report(o,this.getReportURL(),r,"error");case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"reportError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return this.report(new w(e,t,r),n)}},{key:"isLineParasite",value:function(e){return b.some((function(t){return e.includes(t)}))}},{key:"trunkStack",value:function(e){for(var t=e.split("\n");t.length&&this.isLineParasite(t[0]);)t.shift();return t}},{key:"__stackFirstLineParser",value:function(e){var t,r=E.find((function(r){return t=r.test(e)}));return!!r&&r.parse(t)}},{key:"__stackFirstLineSearcher",value:function(e){for(var t=0;e.length>t;t++){var r=e[t];if(r){var n=this.__stackFirstLineParser(r);if(n)return n}}return!1}},{key:"parseStack",value:function(e){try{var r=this.trunkStack(e);if(!this.__stackFirstLineSearcher(r))return{stack:r};var n=this.__stackFirstLineSearcher(r);return n?function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stack:r},n):{stack:r}}catch(e){return _.error(e),!1}}},{key:"extractDataFromError",value:function(e,t){var r=e.getDetails();if(r.stack){var n=this.parseStack(r.stack);n&&n.stack&&(t?(r.stack=n.stack.join("\n"),O.forEach((function(e){n[e]&&(r[e]=n[e])}))):O.forEach((function(e){r[e]||(r[e]=n[e])})))}return r}},{key:"packError",value:(u=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],(n={}).details=this.extractDataFromError(t,r),e.next=5,this.tryToGetSourceBlock(n);case 5:return n.options=t.options,n.env=t.env,n.origin=this.origin?this.origin:{},e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"tryToGetSourceBlock",value:(i=n(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.details.fileName||isNaN(t.details.lineNumber)){e.next=11;break}return e.prev=1,e.next=4,this.loadSources(t.details.fileName);case 4:(r=e.sent)&&(n=this.extractLinesFromFile(r,parseInt(t.details.lineNumber)),t.lines=n),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e){return i.apply(this,arguments)})},{key:"extractLinesFromFile",value:function(e,t){var r=e.split("\n"),n=(t=parseInt(t)-1)-6,o=t+6;n<0&&(n=0),o>r.length-1&&(o=r.length-1);for(var i=[],a=n;a<o;a++)i.push({l:a+1,txt:r[a],color:{danger:t===a}});return i}},{key:"getReportURL",value:function(){return void 0!==this.url?this.url:window.NOT_NODE_ERROR_URL_BROWSER&&window.NOT_NODE_ERROR_URL_BROWSER.length>0?window.NOT_NODE_ERROR_URL_BROWSER:N.length>0?N:"/api/error"}},{key:"getReportKey",value:function(){return void 0!==this.key?this.key:window.NOT_NODE_ERROR_KEY&&window.NOT_NODE_ERROR_KEY.length>0?window.NOT_NODE_ERROR_KEY:S.length>0?S:""}},{key:"_report",value:function(e,t){var r={report:e,type:"error",key:this.getReportKey()};return fetch(t,{method:"PUT",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)})}},{key:"loadSources",value:(r=n(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:if(r=e.sent,200!==parseInt(r.status)){e.next=9;break}return e.next=6,r.text();case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"registerError",value:function(e){this.registerAll&&this.report(e.error)}}]),e}();s(j,"notError",w),s(j,"notValidationError",k),s(j,"notRequestError",R);var A="/browser/api",x="test.key",L=new(function(e){u(r,e);var t=g(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o(this,r),(n=t.call(this,e)).options=i,n.fill(),n.getTime(),d(n,v(n))}return a(r,[{key:"adopt",value:function(e){return this.parent=e,this}},{key:"getTime",value:function(){var e=new Date;return this.env.date={timestamp:e.getTime(),offset:e.getTimezoneOffset()},this.env.date}},{key:"report",value:function(){var e=this.packError();return this._report(e,this.getReportURL())}},{key:"packError",value:function(){var e={};return this.parent&&(e.parent={columnNumber:this.parent.columnNumber,fileName:this.parent.fileName,lineNumber:this.parent.lineNumber,message:this.parent.message,name:this.parent.name,stack:this.parent.stack}),e.details={columnNumber:this.columnNumber,fileName:this.fileName,lineNumber:this.lineNumber,name:this.name,message:this.message,stack:this.stack},e.options=this.options,e.env=this.env,e}},{key:"fill",value:function(){return this.env={browser:!0,node:!1,location:{hash:window.location.hash,port:window.location.port,protocol:window.location.protocol,search:window.location.search,host:window.location.host,url:window.location.url,href:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname}},this}},{key:"getReportURL",value:function(){return window.NOT_NODE_ERROR_URL_BROWSER&&window.NOT_NODE_ERROR_URL_BROWSER.length>0?window.NOT_NODE_ERROR_URL_BROWSER:A.length>0?A:"https://appmon.ru/api/key/collect"}},{key:"getReportKey",value:function(){return window.NOT_NODE_ERROR_KEY&&window.NOT_NODE_ERROR_KEY.length>0?window.NOT_NODE_ERROR_KEY:x.length>0?x:""}},{key:"_report",value:function(e,t){var r={key:this.getReportKey(),report:e,type:"error"};return fetch(t,{method:"PUT",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)})}}]),r}(h(Error)));return e.notError=w,e.notErrorStandalone=L,e.notReporter=j,e.notRequestError=R,e.notValidationError=k,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
