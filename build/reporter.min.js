var notErrorReporter=function(){"use strict";function t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function e(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function r(t){return function(){var r=this,n=arguments;return new Promise((function(o,i){var a=t.apply(r,n);function u(t){e(a,o,i,u,c,"next",t)}function c(t){e(a,o,i,u,c,"throw",t)}u(void 0)}))}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function l(t,e,r){return(l=s()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&c(o,r.prototype),o}).apply(null,arguments)}function f(t){var e="function"==typeof Map?new Map:void 0;return(f=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return l(t,arguments,u(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,t)})(t)}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?p(t):e}function v(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(a,t);var e,r,o=(e=a,r=s(),function(){var t,n=u(e);if(r){var o=u(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)});function a(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n(this,a),(e=o.call(this,t)).options=r,e.adopt(i),e.fill(),e.getTime(),h(e,p(e))}return i(a,[{key:"adopt",value:function(t){return t&&(this.parent=t),this}},{key:"getStack",value:function(){return this.parent?this.parent.stack:this.stack}},{key:"getDetails",value:function(){var t=this;return this.parent&&(t=this.parent),{columnNumber:t.columnNumber,fileName:t.fileName,lineNumber:t.lineNumber,name:t.name,message:t.message,stack:t.stack}}},{key:"getTime",value:function(){var t=new Date;return this.env.date={timestamp:t.getTime(),offset:t.getTimezoneOffset()},this.env.date}},{key:"fill",value:function(){return this.env={browser:!0,node:!1,document:{title:document.title},location:{hash:window.location.hash,port:window.location.port,protocol:window.location.protocol,search:window.location.search,host:window.location.host,url:window.location.url,href:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname},navigator:{appName:navigator.appName,appCodeName:navigator.appCodeName,appVersion:navigator.appVersion,userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,product:navigator.product,onLine:navigator.onLine,cookieEnabled:navigator.cookieEnabled},window:{height:window.innerHeight,width:window.innerWidth}},this}}]),a}(f(Error)),d=["report@","notError@"],m=["file","path","type","line","column","function"],w=[{test:function(t){var e=v(t.matchAll(/(.*)@(.+):(\d+):(\d+)/gi));if(e.length){var r=e[0];if(r&&r.length>2)return r}return!1},parse:function(t){if(!t)return!1}},{test:function(t){var e=v(t.matchAll(/\sat\s(.+)\s\((.+)\)/gi));if(e.length){var r=e[0];if(r&&r.length>2)return r}return!1},parse:function(t){if(t){var e=t[1].split("."),r=t[2].split(":"),n=r[0].split("/"),o=n[n.length-1];n.pop();var i,a=n.join("/"),u=parseInt(r[1]),c=parseInt(r[2]),s=e[e.length-1];return s.replaceAll&&(s=s.replaceAll("/","").replaceAll("\\","").replaceAll(">","").replaceAll("<","")),n&&n.length&&(i=n.pop()),{file:o,path:a,line:u,column:c,function:s,type:i}}return!1}}],k=window.console,b="https://appmon.ru/api/key/collect",O={envFirst:!1,origin:{},url:void 0,key:void 0,registerAll:!0};return function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;n(this,e);var r=t.envFirst,o=t.origin,i=t.url,a=t.key,u=t.registerAll;return this.envFirst=r,this.processWatching=!1,this.setOrigin(o),this.setKey(a),this.setURL(i),this.setRegisterAll(u),window.addEventListener("error",this.registerError.bind(this)),this}var o,u,c,s;return i(e,[{key:"setOrigin",value:function(t){return this.origin=t,this}},{key:"setKey",value:function(t){return this.key=t,this}},{key:"setURL",value:function(t){return this.url=t,this}},{key:"setRegisterAll",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.registerAll=t,this}},{key:"report",value:(s=r(regeneratorRuntime.mark((function t(e,r){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!1,"notError"!==e.constructor.name&&(e=new g(e.message,{},e),n=!0),t.next=4,this.packError(e,n);case 4:return o=t.sent,t.next=7,this._report(o,this.getReportURL(),r,"error");case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"reportError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return this.report(new g(t,e,r),n)}},{key:"isLineParasite",value:function(t){return d.some((function(e){return t.includes(e)}))}},{key:"trunkStack",value:function(t){for(var e=t.split("\n");e.length&&this.isLineParasite(e[0]);)e.shift();return e}},{key:"__stackFirstLineParser",value:function(t){var e,r=w.find((function(r){return e=r.test(t)}));return!!r&&r.parse(e)}},{key:"__stackFirstLineSearcher",value:function(t){for(var e=0;t.length>e;e++){var r=t[e];if(r){var n=this.__stackFirstLineParser(r);if(n)return n}}return!1}},{key:"parseStack",value:function(e){try{var r=this.trunkStack(e);if(!this.__stackFirstLineSearcher(r))return{stack:r};var n=this.__stackFirstLineSearcher(r);return n?function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({stack:r},n):{stack:r}}catch(t){return k.error(t),!1}}},{key:"extractDataFromError",value:function(t,e){var r=t.getDetails();if(r.stack){var n=this.parseStack(r.stack);n&&n.stack&&(e?(r.stack=n.stack.join("\n"),m.forEach((function(t){n[t]&&(r[t]=n[t])}))):m.forEach((function(t){r[t]||(r[t]=n[t])})))}return r}},{key:"packError",value:(c=r(regeneratorRuntime.mark((function t(e){var r,n,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],(n={}).details=this.extractDataFromError(e,r),t.next=5,this.tryToGetSourceBlock(n);case 5:return n.options=e.options,n.env=e.env,n.origin=this.origin?this.origin:{},t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"tryToGetSourceBlock",value:(u=r(regeneratorRuntime.mark((function t(e){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.details.filePath||isNaN(e.details.lineNumber)){t.next=11;break}return t.prev=1,t.next=4,this.loadSources(e.details.filePath);case 4:(r=t.sent)&&(n=this.extractLinesFromFile(r,parseInt(e.details.lineNumber)),e.lines=n),t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,this,[[1,8]])}))),function(t){return u.apply(this,arguments)})},{key:"extractLinesFromFile",value:function(t,e){var r=t.split("\n"),n=(e=parseInt(e)-1)-6,o=e+6;n<0&&(n=0),o>r.length-1&&(o=r.length-1);for(var i=[],a=n;a<o;a++)i.push({l:a+1,txt:r[a],color:{danger:e===a}});return i}},{key:"getReportURL",value:function(){return void 0!==this.url?this.url:window.NOT_NODE_ERROR_URL_BROWSER&&window.NOT_NODE_ERROR_URL_BROWSER.length>0?window.NOT_NODE_ERROR_URL_BROWSER:b.length>0?b:"/api/error"}},{key:"getReportKey",value:function(){return void 0!==this.key?this.key:window.NOT_NODE_ERROR_KEY&&window.NOT_NODE_ERROR_KEY.length>0?window.NOT_NODE_ERROR_KEY:""}},{key:"_report",value:function(t,e){console.log(t);var r={report:t,type:"error",key:this.getReportKey()};return fetch(e,{method:"PUT",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)})}},{key:"loadSources",value:(o=r(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if(r=t.sent,200!==parseInt(r.status)){t.next=9;break}return t.next=6,r.text();case 6:return t.abrupt("return",t.sent);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"registerError",value:function(t){this.registerAll&&this.report(t.error)}}]),e}()}();
