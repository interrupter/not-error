var notErrorReporter=function(){"use strict";class e extends Error{constructor(e,t={},r=null){return super(e),this.options=t,this.adopt(r),this.fill(),this.getTime(),this}adopt(e){return e&&(this.parent=e),this}getTime(){let e=new Date;return this.env.date={timestamp:e.getTime(),offset:e.getTimezoneOffset()},this.env.date}fill(){return this.env={browser:!0,node:!1,location:{hash:window.location.hash,port:window.location.port,protocol:window.location.protocol,search:window.location.search,host:window.location.host,url:window.location.url,href:window.location.href,hostname:window.location.hostname,pathname:window.location.pathname},navigator:{appName:navigator.appName,appCodeName:navigator.appCodeName,appVersion:navigator.appVersion,userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,product:navigator.product,onLine:navigator.onLine,cookieEnabled:navigator.cookieEnabled},window:{height:window.innerHeight,width:window.innerWidth}},this}}const t=["report@","notError@"],r=window.console,n="https://appmon.ru/api/key/collect";return class{constructor(e=!1){return this.envFirst=e,this.processWatching=!1,this.origin={},this}setOrigin(e){this.origin=e}report(t,r){t instanceof e||(t=new e(t.message,{},t));let n=this.packError(t);return this._report(n,this.getReportURL(),r,"error")}reportError(t,r={},n=null,o){return this.report(new e(t,r,n),o)}isLineParasite(e){return t.some((t=>e.includes(t)))}trunkStack(e){let t=e.split("\n");for(;t.length&&this.isLineParasite(t[0]);)t.shift();return t}parseStack(e){try{let t=[...this.trunkStack(e)[0].matchAll(/(.*)@(.+):(\d+):(\d+)/gi)][0],r=t[1].replace("/","").replace("\\","").replace(">","").replace("<",""),n=t[2].split("/"),o=n.length?n[n.length-1]:"",i=n.length>1?n[n.length-2]:"",a=t[3];return{functionName:r,type:i,fileName:o,lineNumber:parseInt(a)}}catch(e){return r.error(e),!1}}extractDataFromError(e){let t={columnNumber:e.columnNumber,fileName:e.fileName,lineNumber:e.lineNumber,name:e.name,message:e.message,stack:e.stack};if(t.stack){let e=this.parseStack(t.stack);e&&(t.fileName||(t.fileName=e.fileName),t.lineNumber||(t.lineNumber=e.lineNumber),t.functionName||(t.functionName=e.functionName),t.type||(t.type=e.type))}return t}packError(e){let t={};return Object.prototype.hasOwnProperty.call(e,"parent")&&void 0!==e.parent&&e.parent&&(t.parent=this.extractDataFromError(e.parent)),t.details=this.extractDataFromError(e),t.options=e.options,t.env=e.env,t.origin=this.origin?this.origin:{},t}getReportURL(){return window.NOT_NODE_ERROR_URL_BROWSER&&window.NOT_NODE_ERROR_URL_BROWSER.length>0?window.NOT_NODE_ERROR_URL_BROWSER:n.length>0?n:"/api/error"}getReportKey(){return window.NOT_NODE_ERROR_KEY&&window.NOT_NODE_ERROR_KEY.length>0?window.NOT_NODE_ERROR_KEY:""}_report(e,t){let r={report:e,type:"error",key:this.getReportKey()};return fetch(t,{method:"PUT",cache:"no-cache",headers:{"Content-Type":"application/json; charset=utf-8"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(r)})}}}();
